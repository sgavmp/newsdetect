<!DOCTYPE html>
<html lang="es" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head th:include="base :: head">
</head>
<body>
	<div
		class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
		<header
			class="demo-header mdl-layout__header mdl-color--white mdl-color--grey-100 mdl-color-text--grey-600"
			th:replace="base :: menu-superior"> </header>
		<div
			class="demo-drawer mdl-layout__drawer mdl-color--blue-grey-800 mdl-color-text--primary"
			th:include="base :: menu-izquierdo"></div>
		<main
			class="mdl-layout__content mdl-color--withe mdl-typography--text-center mdl-grid"
			th:fragment="alerts">
		<div id="alertas"
			class="mdl-card mdl-cell mdl-cell--10-col mdl-cell--1-offset ">
			<div class="mdl-card__title">
				<h2
					class="mdl-card__title-text mdl-color-text--primary text-underline"><span th:text="${resumealerts}">Alertas
					Sanitarias</span></h2>
			</div>
			<div class="mdl-grid mdl-card__supporting-text">
				<table
					class="mdl-cell mdl-cell--5-col mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
					<thead class="mdl-color--primary">
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"
								colspan="2" th:inline="text"><span th:text="${resumerecentalerts}">Alertas Recientes</span></th>
						</tr>
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumenamealerts}">Nombre
								Alerta</span></th>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumescore}">Score</span></th>
						</tr>
					</thead>
					<tbody>
						<tr th:unless="${#lists.isEmpty(alertsScoreLast2Days)}"
							th:each="alert,stat : ${alertsScoreLast2Days}"
							th:class="${stat.count}%2==0?'table-par':'table-impar'"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric"><a
								th:text="${alert[1]}"
								th:href="@{/alerts/get/{id}(id=${alert[0]})}">Acrylic</a></td>
							<td th:text="${#numbers.formatDecimal(alert[4],1,2)}">250</td>
						</tr>
						<tr th:if="${#lists.isEmpty(alertsScoreLast2Days)}"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric" colspan="2"><span th:text="${resumenorecentalerts}">No hay Alertas recientes</span></td>
						</tr>
					</tbody>
				</table>
				<table
					class="mdl-cell mdl-cell--5-col mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
					<thead class="mdl-color--primary">
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"
								colspan="2" th:inline="text"><span th:text="${resumethisweek}">Esta semana</span>
								([[${#dates.format(hoy, 'dd/MMM/yyyy')}]] -
								[[${#dates.format(semana, 'dd/MMM/yyyy')}]])</th>
						</tr>
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumenamealerts}">Nombre
								Alerta</span></th>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumescore}">Score</span></th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="alert,stat : ${alertsScoreWeek}"
							th:class="${stat.count}%2==0?'table-par':'table-impar'"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric"><a
								th:text="${alert[1]}"
								th:href="@{/alerts/get/{id}(id=${alert[0]})}">Acrylic</a></td>
							<td th:text="${#numbers.formatDecimal(alert[4],1,2)}">250</td>
						</tr>
						<tr th:if="${#lists.isEmpty(alertsScoreWeek)}"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric" colspan="2"><span th:text="${resumenorecentalerts}">No hay Alertas recientes</span></td>
						</tr>
					</tbody>
				</table>
				<div class="mdl-cell mdl-cell--2-col">
					<a th:href="@{/alerts/detect}"
						class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored alerta-boton"><span th:text="${resumeview}">View</span></a>
					<a th:href="@{/alerts/list}"
						class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored alerta-boton"><span th:text="${resumeslist}">List</span></a>
				</div>
			</div>
		</div>
		<div id="riesgos"
			class="mdl-card mdl-cell mdl-cell--10-col mdl-cell--1-offset ">
			<div class="mdl-card__title">
				<h2
					class="mdl-card__title-text mdl-color-text--primary text-underline"><span th:text="${resumesrisk}">Riesgos</span></h2>
			</div>
			<div class="mdl-grid mdl-card__supporting-text">
				<table
					class="mdl-cell mdl-cell--5-col mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
					<thead class="mdl-color--primary">
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"
								colspan="3" th:inline="text"><span th:text="${resumesrecentrisk}">Riesgos recientes</span></th>
						</tr>
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumesnamerisk}">Nombre
								Riesgo</span></th>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumesnscorerisk}">Score</span></th>
						</tr>
					</thead>
					<tbody>
						<tr th:unless="${#lists.isEmpty(risksScoreLast2Days)}"
							th:each="alert,stat : ${risksScoreLast2Days}"
							th:class="${stat.count}%2==0?'table-par':'table-impar'"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric"><a
								th:text="${alert[1]}"
								th:href="@{/risks/get/{id}(id=${alert[0]})}">Acrylic</a></td>
							<td th:text="${#numbers.formatDecimal(alert[4],1,2)}">250</td>
						</tr>
						<tr th:if="${#lists.isEmpty(risksScoreLast2Days)}" class="table-impar">
							<td class="mdl-data-table__cell--non-numeric" colspan="3"><span th:text="${resumesnorecentrisk}">No hay Riesgos recientes</span></td>
						</tr>
					</tbody>
				</table>
				<table
					class="mdl-cell mdl-cell--5-col mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
					<thead class="mdl-color--primary">
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"
								colspan="3" th:inline="text"><span th:text="${resumethisweek}">Esta semana</span>
								([[${#dates.format(hoy, 'dd/MMM/yyyy')}]] -
								[[${#dates.format(semana, 'dd/MMM/yyyy')}]])</th>
						</tr>
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumesnamerisk}">Nombre
								Riesgo</span></th>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumesnscorerisk}">Score</span></th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="alert,stat : ${risksScoreWeek}"
							th:class="${stat.count}%2==0?'table-par':'table-impar'"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric"><a
								th:text="${alert[1]}"
								th:href="@{/risks/get/{id}(id=${alert[0]})}">Acrylic</a></td>
							<td th:text="${#numbers.formatDecimal(alert[4],1,2)}">250</td>
						</tr>
						<tr th:if="${#lists.isEmpty(risksScoreWeek)}"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric" colspan="2"><span th:text="${resumesnorecentrisk}">No hay Riesgos recientes</span></td>
						</tr>
					</tbody>
				</table>
				<div class="mdl-cell mdl-cell--2-col">
					<a th:href="@{/risks/detect}"
						class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored alerta-boton"><span th:text="${resumeview}">View</span></a>
					<a th:href="@{/risks/list}"
						class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored alerta-boton"><span th:text="${resumeslist}">List</span></a>
				</div>
			</div>
		</div>
		<div id="web"
			class="mdl-card mdl-cell mdl-cell--10-col mdl-cell--1-offset ">
			<div class="mdl-card__title">
				<h2
					class="mdl-card__title-text mdl-color-text--primary text-underline"><span th:text="${resumestadistics}">Estadisticas web</span></h2>
			</div>
			<div class="mdl-card__supporting-text mdl-grid">
				<table
					class="mdl-cell mdl-cell--6-col mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
					<thead class="mdl-color--grey">
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumedatetime}">Fecha
								y Hora</span></th>
							<th class="mdl-color-text--white"><span th:text="${resumenewss}">#Noticias</span></th>
							<th class="mdl-color-text--white"><span th:text="${resumealertss}">#Alertas</span></th>
							<th class="mdl-color-text--white"><span th:text="${resumeriskss}">#Riesgos</span></th>
							<th class="mdl-color-text--white"><span th:text="${resumewebsitesanal}">#WebsitesAnalizado</span></th>
							<th class="mdl-color-text--white"><span th:text="${resumeduration}">#Duracion</span></th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="scrap,stat : ${scrapStat}"
							th:class="${stat.count}%2==0?'table-par':'table-impar'"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric"
								th:text="${scrap.fecha}">Acrylic (Transparent)</td>
							<td th:text="${scrap.noticias}">250</td>
							<td th:text="${scrap.alertas}">250</td>
							<td th:text="${scrap.riesgos}">60</td>
							<td th:text="${scrap.totalrecuperadas}">250</td>
							<td th:text="${scrap.tiempodeuso}">60</td>
						</tr>
					</tbody>
				</table>
			</div>
				
				<div id="chart-semanal"></div>
				<div id="chart-semanal2"></div>
				
			
		</div>
		<div id="lugares"
			class="mdl-card mdl-cell mdl-cell--10-col mdl-cell--1-offset ">
			<div class="mdl-card__title">
				<h2
					class="mdl-card__title-text mdl-color-text--primary text-underline"><span th:text="${resumeprovideralertlevels}">Nivel
					de alerta de proveedores</span></h2>
			</div>
			<div class="mdl-card__supporting-text mdl-grid">
				<table
					class="mdl-cell mdl-cell--6-col mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
					<thead class="mdl-color--grey">
						<tr>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumeprovidername}">Proveedor</span></th>
							<th
								class="mdl-data-table__cell--non-numeric mdl-color-text--white"><span th:text="${resumeproviderlevel}">Nivel
								de Alerta</span></th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="loc,stat : ${locationsScoreWeek}"
							th:class="${stat.count}%2==0?'table-par':'table-impar'"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric" th:text="${loc[0]}">Acrylic
								(Transparent)</td>
							<td th:text="${#numbers.formatDecimal(loc[1],1,2)}">250</td>
						</tr>
						<tr th:if="${#lists.isEmpty(locationsScoreWeek)}"
							class="table-impar">
							<td class="mdl-data-table__cell--non-numeric" colspan="2"><span th:text="${resumeprovidernodata}">No hay datos de proveedores.</span></td>
						</tr>
					</tbody>
				</table>
				<div class="mdl-cell mdl-cell--6-col">
					<div><span th:text="${resumemap}">Mapa</span></div>
					<div id="container" style="width: 100%; height: 100%;"></div>
				</div>
			</div>
		</div>
		</main>
		<footer th:include="base :: footer"> </footer>
		<!-- Load d3.js and c3.js -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"
			charset="utf-8"></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
		<script
			src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
		<script th:src="@{/static/js/datamaps.world.min.js}"
			src="/datamaps.world.min.js"></script>
		<script th:inline="javascript">
		/*<![CDATA[*/
		           $(document)
				.ready( function(){
				    var chart = c3.generate({
						bindto : '#chart-semanal',
						size: {
					        height: 200
					    },
						data : {
							x: 'labels',
							url: [[@{'/ajax/scrap/week2'}]],
							mimeType: 'json',							
							types : {
								noticias : 'area-spline',
/* 								alertas : 'area-spline' */
							}, names: {
								noticias: /*[[${resumegrapnews}]]*/ 'Noticias',
					        }
						},
						axis : {
							x : {
								type : 'category'
							}
						}
					});
				    
				    var chart = c3.generate({
						bindto : '#chart-semanal2',
						size: {
					        height: 200
					    },
						data : {
							x: 'labels',
							url: [[@{'/ajax/scrap/week3'}]],
							mimeType: 'json',							
							types : {
								alertasexp : 'area-spline', 
								alertas : 'area-spline'
							},
							colors: {
								alertas: '#f27606',
								alertasexp: 'red',
					        },
					        names: {
					        	alertas: /*[[${resumegrapalertsre}]]*/ 'Alertas Reales',
					        	alertasexp: /*[[${resumegrapalertsexp}]]*/ 'Alertas Esperadas'
					        }
						},
						axis : {
							x : {
								type : 'category'
							}
						}
					});
				    
				    var countries = [[${allCountriesAfects}]];
					var data = {}
					for (var t in countries) {
						var temp = {'fillKey' : t};
						data[t] = temp;
					}
					var map = new Datamap({
						element: document.getElementById('container'),
						responsive: true,
						fills: countries,
				        data: data
					});
					//alternatively with d3
				    d3.select(window).on('resize', function() {
				        map.resize();
				    });
				});
		           /*]]>*/
		</script>
		
	</div>
</body>
</html>
